<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Simple Upload Log</title>
Â  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.6/dist/umd/supabase.min.js"></script>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: sans-serif;
Â  Â  Â  background: #f0f2f5;
Â  Â  Â  padding: 2rem;
Â  Â  Â  max-width: 600px;
Â  Â  Â  margin: auto;
Â  Â  }
Â  Â  .card {
Â  Â  Â  background: white;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  padding: 1rem;
Â  Â  Â  margin-bottom: 1rem;
Â  Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
Â  Â  }
Â  Â  .timestamp {
Â  Â  Â  color: #888;
Â  Â  Â  font-size: 0.9rem;
Â  Â  }
Â  Â  .note {
Â  Â  Â  margin-top: 0.5rem;
Â  Â  }
Â  Â  .preview-img {
Â  Â  Â  max-width: 100%;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  margin-top: 0.5rem;
Â  Â  }
Â  </style>
</head>
<body>

Â  <h2>ğŸ“¤ Upload File Log</h2>
Â  <div class="card">
Â  Â  <input type="file" id="fileInput" /><br><br>
Â  Â  <textarea id="noteInput" rows="3" placeholder="à¹€à¸‚à¸µà¸¢à¸™à¹‚à¸™à¹‰à¸•à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰..." style="width: 100%;"></textarea><br><br>
Â  Â  <button onclick="upload()">Upload</button>
Â  </div>

Â  <h3>ğŸ“ Uploaded Logs</h3>
Â  <div id="logArea"></div>

Â  <script>
Â  Â  const supabaseUrl = 'https://fkntlawaawawiusmjsez.supabase.co';
Â  Â  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrbnRsYXdhYXdhd2l1c21qc2V6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5ODcxMjAsImV4cCI6MjA2NTU2MzEyMH0.G-_fLzcpvPla3dUYNCV7qh0j-JHo1Ahr5fS7fQkHdpw';
Â  Â  const client = supabase.createClient(supabaseUrl, supabaseKey);

Â  Â  const logArea = document.getElementById("logArea");

Â  Â  async function loadUploads() {
Â  Â  Â  const { data, error } = await client
Â  Â  Â  Â  .from('uploads')
Â  Â  Â  Â  .select('*')
Â  Â  Â  Â  .order('created_at', { ascending: false });

Â  Â  Â  if (error) return console.error(error);
Â  Â  Â  logArea.innerHTML = '';
Â  Â  Â  data.forEach(renderItem);
Â  Â  }

Â  Â  function renderItem(item) {
Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  card.className = "card";
Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  <div><strong>${item.file_name}</strong></div>
Â  Â  Â  Â  <div class="note">ğŸ“ ${item.note}</div>
Â  Â  Â  Â  <img src="${item.file_url}" class="preview-img" />
Â  Â  Â  Â  <div class="timestamp">ğŸ“… ${new Date(item.created_at).toLocaleString()}</div>
Â  Â  Â  `;
Â  Â  Â  logArea.appendChild(card);
Â  Â  }

Â  Â  async function upload() {
  const file = document.getElementById("fileInput").files[0]
  const note = document.getElementById("noteInput").value
  if (!file) return alert("à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¹„à¸Ÿà¸¥à¹Œ")

  const path = `${Date.now()}_${file.name}`

  // ğŸ“¦ Upload à¹„à¸›à¸—à¸µà¹ˆ bucket
  const { data: uploadData, error: uploadError } = await supabase
    .storage
    .from('uploads')
    .upload(path, file)
  if (uploadError) return console.error("âŒ Upload Error:", uploadError)

  // ğŸŒ Get Public URL
  const { data: urlData, error: urlError } = supabase
    .storage
    .from('uploads')
    .getPublicUrl(path)
  if (urlError) return console.error("âŒ URL Error:", urlError)

  const publicUrl = urlData.publicUrl
  console.log("ğŸ“¸ File URL =", publicUrl)

  // ğŸ“ Insert à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸‚à¹‰à¸² Table
  const { data, error: insertError } = await supabase
    .from('uploads')
    .insert({
      file_name: file.name,
      file_url: publicUrl,
      note
    })
  if (insertError) return console.error("âŒ Insert Error:", insertError)

  // ğŸ§¹ Clear form + reload
  document.getElementById("fileInput").value = ""
  document.getElementById("noteInput").value = ""
  loadUploads()
}


Â  Â  loadUploads();
Â  </script>

</body>
</html>
